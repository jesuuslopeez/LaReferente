<section class="news-page">
  <header class="news-page__header">
    <section class="news-page__header-content">
      <h1 class="news-page__title">Noticias</h1>
      <p class="news-page__subtitle">Últimas noticias del fútbol español</p>
    </section>
    @if (authService.esEditor()) {
      <a routerLink="/admin/noticias/nueva" class="news-page__add-btn">
        <svg class="news-page__add-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
        </svg>
        Añadir noticia
      </a>
    }
  </header>

  <!-- Toolbar: Búsqueda y Filtros -->
  <section class="news-page__toolbar">
    <section class="news-page__search">
      <svg class="news-page__search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
      </svg>
      <input
        type="text"
        class="news-page__search-input"
        placeholder="Buscar noticias..."
        [formControl]="busquedaControl"
      />
    </section>

    <section class="news-page__filters">
      @for (cat of categorias; track cat.valor) {
        <button
          class="news-page__filter-btn"
          [class.news-page__filter-btn--active]="filtroActivo() === cat.valor"
          (click)="setFiltro(cat.valor)"
        >
          {{ cat.texto }}
        </button>
      }
    </section>
  </section>

  <!-- Loading State -->
  @if (isLoading) {
    <section class="news-page__loading">
      <span class="news-page__spinner"></span>
      <p>Cargando noticias...</p>
    </section>
  }

  <!-- Error State -->
  @if (hasError) {
    <section class="news-page__error">
      <svg class="news-page__error-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
      </svg>
      <h2>Error al cargar las noticias</h2>
      <p>{{ errorMessage }}</p>
      <button class="news-page__retry-btn" (click)="loadNews()">
        Reintentar
      </button>
    </section>
  }

  <!-- Empty State -->
  @if (isEmpty) {
    <section class="news-page__empty">
      <svg class="news-page__empty-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z" />
      </svg>
      <h2>No hay noticias disponibles</h2>
      <p>Vuelve más tarde para ver las últimas novedades</p>
    </section>
  }

  <!-- Data State -->
  @if (hasData) {
    <section class="news-page__list">
      @for (noticia of noticias; track noticia.id) {
        <article class="news-card">
          <section class="news-card__image-wrapper">
            @if (noticia.imagenPrincipalUrl) {
              <img
                [src]="noticia.imagenPrincipalUrl"
                [alt]="noticia.titulo"
                class="news-card__image"
                loading="lazy"
                decoding="async"
              />
            } @else {
              <section class="news-card__image news-card__image--placeholder">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z" />
                </svg>
              </section>
            }
          </section>

          <section class="news-card__content">
            <header class="news-card__header">
              <span class="news-card__category">{{ getCategoryLabel(noticia.categoria) }}</span>
              <span class="news-card__date">{{ formatDate(noticia.fechaPublicacion) }}</span>
            </header>

            <h2 class="news-card__title">{{ noticia.titulo }}</h2>

            @if (noticia.subtitulo) {
              <p class="news-card__subtitle">{{ noticia.subtitulo }}</p>
            }

            <footer class="news-card__footer">
              <span class="news-card__author">Por {{ noticia.autorNombre }}</span>
              <a [routerLink]="['/noticias', noticia.id]" class="news-card__link">
                Leer noticia
                <svg class="news-card__link-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"/>
                </svg>
              </a>
            </footer>
          </section>
        </article>
      }
    </section>
  }
</section>
