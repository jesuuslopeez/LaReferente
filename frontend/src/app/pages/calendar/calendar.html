<section class="calendar">
  <!-- Cabecera -->
  <header class="calendar__header">
    <section class="calendar__header-content">
      <h1 class="calendar__title">Calendario</h1>
      <p class="calendar__description">
        Próximos partidos y resultados del fútbol español
      </p>
    </section>
    @if (authService.esEditor()) {
      <a routerLink="/admin/encuentros/nuevo" class="calendar__add-btn">
        <svg class="calendar__add-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" aria-hidden="true">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
        </svg>
        Añadir encuentro
      </a>
    }
  </header>

  <!-- Filtros de estado -->
  <section class="calendar__filters">
    @for (estado of estados; track estado.valor) {
      <button
        class="calendar__filter-btn"
        [class.calendar__filter-btn--active]="filtroEstado() === estado.valor"
        (click)="setFiltroEstado(estado.valor)">
        {{ estado.texto }}
      </button>
    }
  </section>

  <!-- Lista de partidos agrupados por fecha -->
  <section class="calendar__matches">
    @for (grupo of partidosPorFecha(); track grupo.fecha) {
      <article class="calendar__date-group">
        <h2 class="calendar__date-title">{{ formatFecha(grupo.fecha) }}</h2>

        <section class="calendar__matches-list">
          @for (partido of grupo.partidos; track partido.id) {
            <article class="match" [class]="getEstadoClass(partido.estado)">
              <section class="match__header">
                <span class="match__competition">{{ partido.competicionNombre }}</span>
                @if (partido.jornada) {
                  <span class="match__jornada">Jornada {{ partido.jornada }}</span>
                }
                <span class="match__status">{{ getEstadoTexto(partido.estado) }}</span>
              </section>

              <section class="match__content">
                <!-- Equipo Local -->
                <section class="match__team match__team--local">
                  @if (partido.equipoLocalLogo) {
                    <img
                      class="match__team-logo"
                      [src]="partido.equipoLocalLogo"
                      [alt]="partido.equipoLocalNombre"
                      loading="lazy"
                    />
                  } @else {
                    <article class="match__team-logo match__team-logo--placeholder">
                      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" aria-hidden="true">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 21v-4m0 0V5a2 2 0 012-2h6.5l1 1H21l-3 6 3 6h-8.5l-1-1H5a2 2 0 00-2 2zm9-13.5V9"/>
                      </svg>
                    </article>
                  }
                  <span class="match__team-name">{{ partido.equipoLocalNombre }}</span>
                </section>

                <!-- Resultado / Hora -->
                <section class="match__score">
                  @if (partido.estado === 'FINALIZADO' || partido.estado === 'EN_CURSO') {
                    <span class="match__score-value">
                      {{ partido.golesLocal ?? 0 }} - {{ partido.golesVisitante ?? 0 }}
                    </span>
                  } @else {
                    <span class="match__time">{{ formatHora(partido.fechaHora) }}</span>
                  }
                </section>

                <!-- Equipo Visitante -->
                <section class="match__team match__team--away">
                  @if (partido.equipoVisitanteLogo) {
                    <img
                      class="match__team-logo"
                      [src]="partido.equipoVisitanteLogo"
                      [alt]="partido.equipoVisitanteNombre"
                      loading="lazy"
                    />
                  } @else {
                    <article class="match__team-logo match__team-logo--placeholder">
                      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" aria-hidden="true">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 21v-4m0 0V5a2 2 0 012-2h6.5l1 1H21l-3 6 3 6h-8.5l-1-1H5a2 2 0 00-2 2zm9-13.5V9"/>
                      </svg>
                    </article>
                  }
                  <span class="match__team-name">{{ partido.equipoVisitanteNombre }}</span>
                </section>
              </section>

              @if (partido.estadio) {
                <section class="match__footer">
                  <svg class="match__stadium-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" aria-hidden="true">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/>
                  </svg>
                  <span class="match__stadium">{{ partido.estadio }}</span>
                </section>
              }
            </article>
          }
        </section>
      </article>
    } @empty {
      <article class="calendar__empty">
        <svg class="calendar__empty-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" aria-hidden="true">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
        </svg>
        <p>No hay partidos disponibles</p>
      </article>
    }
  </section>
</section>
